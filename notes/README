Two stages for training diffusion models:
Stage 1: Train autoencoder
Stage 2: Train diffusion model
